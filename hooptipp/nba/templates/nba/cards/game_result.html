{% comment %}
NBA game result card - shows the outcome of a completed game prediction.
{% endcomment %}

<article class="rounded-xl border {% if active_user %}{% if user_tip %}{% if is_correct %}border-green-500/50 bg-green-500/5{% else %}border-red-500/50 bg-red-500/5{% endif %}{% else %}border-slate-800 bg-slate-950{% endif %}{% else %}border-slate-800 bg-slate-950{% endif %} p-4">
  
  {# Header #}
  <header class="space-y-1">
    <p class="text-xs uppercase tracking-wide text-slate-500">{{ event.tip_type.name }}</p>
  </header>

  {# Final Score #}
  <div class="mt-3 rounded-lg border border-slate-800 bg-slate-900 p-3">
    <div class="flex items-center justify-between gap-4">
      
      {# Away Team #}
      <div class="flex-1 text-center">
        {% if card_context.away_team_logo %}
          <img src="{{ card_context.away_team_logo }}" 
               alt="{{ card_context.away_team }}" 
               class="mx-auto h-12 w-12 object-contain"
               onerror="this.style.display='none'" />
        {% endif %}
        <div class="flex items-center justify-center gap-2">
          {% if active_user and user_tip and user_tip.prediction == card_context.away_team %}
            <span class="text-lg {% if is_correct %}text-green-400{% else %}text-red-400{% endif %}">
              {% if is_correct %}✅{% else %}❌{% endif %}
            </span>
          {% endif %}
          <p class="mt-1 text-lg font-bold text-slate-200">
            {{ card_context.away_team_tricode }}
          </p>
        </div>
        {% if card_context.away_score is not None %}
          <p class="mt-1 text-2xl font-bold text-slate-300">
            {{ card_context.away_score | floatformat }}
          </p>
        {% endif %}
      </div>
      
      {# Final indicator #}
      <div class="text-center">
        <span class="text-xs uppercase tracking-wide text-slate-500">Final</span>
      </div>
      
      {# Home Team #}
      <div class="flex-1 text-center">
        {% if card_context.home_team_logo %}
          <img src="{{ card_context.home_team_logo }}" 
               alt="{{ card_context.home_team }}" 
               class="mx-auto h-12 w-12 object-contain"
               onerror="this.style.display='none'" />
        {% endif %}
        <div class="flex items-center justify-center gap-2">
          <p class="mt-1 text-lg font-bold text-slate-200">
            {{ card_context.home_team_tricode }}
          </p>
          {% if active_user and user_tip and user_tip.prediction == card_context.home_team %}
            <span class="text-lg {% if is_correct %}text-green-400{% else %}text-red-400{% endif %}">
              {% if is_correct %}✅{% else %}❌{% endif %}
            </span>
          {% endif %}
        </div>
        {% if card_context.home_score is not None %}
          <p class="mt-1 text-2xl font-bold text-slate-300">
            {{ card_context.home_score | floatformat }}
          </p>
        {% endif %}
      </div>
      
    </div>
  </div>

  {# Footer #}
  <div class="mt-3 flex items-center justify-between text-xs text-slate-500">
    <span>Resolved {{ outcome.resolved_at|date:"M d, H:i" }}</span>
    {% if active_user %}
      {% if user_score %}
        <span class="theme-accent-pill inline-flex items-center gap-1 rounded-full px-2 py-1 font-semibold">
          {{ user_score.points_awarded }} pt{{ user_score.points_awarded|pluralize }}
          {% if user_score.is_lock_bonus %}
            <span class="text-xs">({{ user_score.lock_multiplier }}x lock)</span>
          {% endif %}
        </span>
      {% else %}
        <span class="theme-accent-pill inline-flex items-center gap-1 rounded-full px-2 py-1 font-semibold">
          0 pt
        </span>
      {% endif %}
    {% else %}
      <span class="theme-accent-pill inline-flex items-center gap-1 rounded-full px-2 py-1 font-semibold">
        {{ event.points }} pt{{ event.points|pluralize }}
      </span>
    {% endif %}
  </div>

</article>
